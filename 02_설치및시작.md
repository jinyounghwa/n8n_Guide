# 2장: 설치 및 시작

> 로컬 n8n 환경에서 첫 번째 워크플로우를 만듭니다.
> 예상 학습 시간: 20분

## 로컬 n8n 확인하기

당신은 이미 로컬에서 n8n을 설치했습니다! 확인해보겠습니다.

### 1단계: n8n 서버 시작

```bash
# 터미널에서 실행
n8n start

# 또는 (설치 방식에 따라)
docker run -d --name n8n \
  -p 5678:5678 \
  -v ~/.n8n:/home/node/.n8n \
  n8nio/n8n
```

### 2단계: n8n에 접속

브라우저를 열고 다음 주소로 이동하세요:

```
http://localhost:5678
```

### 3단계: 초기 설정

처음 접속하면 사용자 정보를 입력합니다:

```
- 이메일: your-email@example.com
- 비밀번호: 안전한 비밀번호 설정
```

완료되면 대시보드가 나타납니다!

---

## n8n 대시보드 이해하기

### 좌측 메뉴

```
┌─ Dashboard (대시보드)
│   ├─ 최근 워크플로우
│   ├─ 통계
│   └─ 빠른 접근
│
├─ Workflows (워크플로우 목록)
│   ├─ 모든 워크플로우
│   ├─ 스타 표시된 항목
│   └─ 완료된 워크플로우
│
├─ Credentials (크레덴셜)
│   └─ API 키, 인증 정보
│
├─ Executions (실행 기록)
│   ├─ 실행 히스토리
│   ├─ 필터링
│   └─ 상세 정보
│
└─ Settings (설정)
    ├─ 사용자 관리
    ├─ 커스터마이징
    └─ 환경 변수
```

---

## 첫 번째 워크플로우: "Hello World"

### 목표
**Webhook** → **Set (데이터 설정)** → 응답 반환

### 단계 1: 새 워크플로우 생성

1. 대시보드에서 **"+ Add workflow"** 클릭
2. 워크플로우 이름 입력: `My First Workflow`
3. **Create** 클릭

### 단계 2: 트리거 노드 추가 (Webhook)

1. 캔버스에서 **"+"** 버튼 클릭 (또는 화면 우측 **Add node**)
2. **Webhook** 검색
3. **Webhook** 선택

```
설정:
- Authentication: None
- HTTP Method: GET, POST
- Response Code: 200
```

### 단계 3: 데이터 설정 노드 추가 (Set)

1. Webhook 노드의 우측 **"+"** 버튼 클릭
2. **Set** 검색 및 선택

```
Values to Set:
- Name: "message"
- Type: String
- Value: "Hello, n8n! 👋"
```

### 단계 4: 워크플로우 저장 및 활성화

1. 화면 좌상단 **"Save"** 버튼 클릭
2. **"Activate"** 토글을 켜기

```
활성화하면:
✅ 워크플로우가 실시간으로 실행 대기
✅ Webhook URL이 생성됨
```

### 단계 5: 테스트하기

1. Webhook 노드를 선택
2. 우측 패널에서 **"Copy Webhook URL"** 클릭

```
https://your-instance.com/webhook/[unique-id]
```

2. 새 터미널에서 실행:

```bash
# GET 요청
curl https://localhost:5678/webhook/[unique-id]

# 또는 POST 요청
curl -X POST https://localhost:5678/webhook/[unique-id]
```

### 예상 결과

```json
{
  "message": "Hello, n8n! 👋"
}
```

✅ 축하합니다! 첫 워크플로우 완성!

---

## 두 번째 워크플로우: 데이터 처리

### 목표
데이터를 받아서 처리하고 변환하기

```
[Webhook] → [Set] → [수정] → [반환]
           (원본 데이터)
```

### 단계별 구현

#### 1. Webhook 설정
```
- Method: POST
- Response Code: 200
```

#### 2. Set 노드 (원본 데이터 저장)
```json
{
  "original_data": "{{ $json.body }}"
}
```

#### 3. Set 다시 (데이터 수정)
```json
{
  "processed": {
    "message": "{{ $json.original_data.message }}",
    "timestamp": "{{ new Date().toISOString() }}",
    "uppercase": "{{ $json.original_data.message?.toUpperCase() }}"
  }
}
```

#### 4. 테스트
```bash
curl -X POST http://localhost:5678/webhook/[id] \
  -H "Content-Type: application/json" \
  -d '{"message": "hello world"}'
```

### 예상 응답
```json
{
  "processed": {
    "message": "hello world",
    "timestamp": "2024-01-18T10:30:00.000Z",
    "uppercase": "HELLO WORLD"
  }
}
```

---

## 세 번째 워크플로우: 외부 API 호출

### 목표
n8n에서 외부 API 호출하기

```
[Webhook] → [HTTP Request] → [응답 반환]
```

### 단계별 구현

#### 1. Webhook 설정 (POST)

#### 2. HTTP 노드 추가
- **Method**: GET
- **URL**: `https://api.example.com/data`
- **Headers**: (필요시)
  - Authorization: Bearer YOUR_TOKEN

#### 3. 응답 처리 (Set)
```json
{
  "api_response": "{{ $json.body }}",
  "status": "{{ $response.statusCode }}"
}
```

#### 4. 테스트
```bash
curl -X POST http://localhost:5678/webhook/[id]
```

---

## n8n UI 주요 기능

### 노드 선택 및 편집

```
1. 노드 클릭 → 우측에 설정 패널 나타남
2. 설정값 입력 → 실시간 검증
3. 표현식(Expression) 입력 가능
   - {{ $json.field }} (입력 데이터)
   - {{ $nodeId.json.field }} (다른 노드의 데이터)
```

### 표현식 (Expression) 이해하기

```javascript
// 기본 변수 접근
{{ $json.name }}

// 배열 접근
{{ $json.items[0] }}

// 객체 접근
{{ $json.user.email }}

// JavaScript 함수
{{ $json.name.toUpperCase() }}
{{ $json.items.length }}

// 다른 노드의 데이터
{{ $node["Node name"].json.value }}

// 조건부
{{ $json.age > 18 ? "Adult" : "Minor" }}
```

### 워크플로우 실행 및 테스트

```
┌─────────────────────────┐
│  Execute Workflow       │ ← 수동 실행
├─────────────────────────┤
│  Activate Workflow      │ ← 활성화/비활성화
├─────────────────────────┤
│  Save                   │ ← 저장
├─────────────────────────┤
│  Copy Webhook URL       │ ← URL 복사
└─────────────────────────┘
```

---

## 실행 결과 확인

### 실행 과정 보기

1. 워크플로우 실행 후 좌상단 **"Executions"** 탭
2. 최근 실행 기록 표시
3. 실행을 클릭하면 상세 정보 보기

```
실행 정보:
- 실행 시간
- 각 노드별 입출력 데이터
- 에러 메시지 (있을 경우)
- 실행 소요 시간
```

### 각 노드의 데이터 검사

```
노드를 선택하면:
1. 입력 데이터 (Input)
2. 출력 데이터 (Output)
3. 설정값 (Settings)
을 우측 패널에서 확인 가능
```

---

## 일반적인 오류 및 해결법

### 1. "Webhook URL not found"
```
해결:
- 워크플로우가 활성화되어 있는지 확인
- n8n 서버가 실행 중인지 확인
- 올바른 Webhook ID 사용하는지 확인
```

### 2. "Invalid expression"
```
해결:
- 표현식이 유효한 JavaScript인지 확인
- {{ }} 괄호가 정확한지 확인
- 필드명 오류 확인
```

### 3. "Connection refused"
```
해결:
- n8n 서버가 실행 중인지 확인
- 포트 5678이 사용 가능한지 확인
- 방화벽 설정 확인
```

### 4. "Maximum call stack exceeded"
```
해결:
- 무한 루프 확인
- 순환 참조 없는지 확인
- Loop 노드의 배열이 너무 크지 않은지 확인
```

---

## 환경 변수 설정

로컬 개발에서 API 키를 안전하게 관리하려면:

### 1. .env 파일 생성
```
~/.n8n/.env
```

### 2. 환경 변수 추가
```env
CLAUDE_API_KEY=sk-your-api-key
DATABASE_URL=postgresql://...
SLACK_WEBHOOK=https://hooks.slack.com/...
```

### 3. n8n에서 사용
```
{{ $env.CLAUDE_API_KEY }}
{{ $env.DATABASE_URL }}
{{ $env.SLACK_WEBHOOK }}
```

---

## 체크리스트

이 장을 완료했는지 확인하세요:

- [ ] n8n 서버가 실행 중이다
- [ ] 브라우저에서 n8n에 접속할 수 있다
- [ ] 첫 번째 워크플로우를 만들고 실행했다
- [ ] 두 번째 워크플로우로 데이터를 처리했다
- [ ] 세 번째 워크플로우로 외부 API를 호출했다
- [ ] 표현식(Expression)을 사용할 수 있다
- [ ] 실행 결과를 확인할 수 있다

모두 완료했다면, 다음 장 [03_UI와워크스페이스.md](03_UI와워크스페이스.md)로 이동하세요!

---

## 다음 단계

**03_UI와워크스페이스.md**에서 배우는 것:
- n8n의 전체 UI 이해하기
- 다양한 노드 타입 알아보기
- 워크플로우 조직화하기
- 주요 패널 사용법
